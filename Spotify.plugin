#!name=Spotifyå¢å¼º
#!desc=Spotifyæ­Œè¯å¢å¼ºåŠåŒè¯­æ¨¡å—å†…å«rule
#!openUrl=http://boxjs.com/#/app/DualSubs.Spotify
#!author=VirgilClyne
#!homepage=https://github.com/DualSubs
#!manual=https://github.com/DualSubs/Spotify/wiki/ğŸ¿-DualSubs:-ğŸµ-Spotify
#!icon=https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/Spotify.png

[rule]
DOMAIN,audio4-ak-spotify-com.akamaized.net, PROXY
DOMAIN,cdn-spotify-experiments.conductrics.com, PROXY
DOMAIN,heads-ak-spotify-com.akamaized.net, PROXY
DOMAIN,spotify.com.edgesuite.net, PROXY
DOMAIN,spotify.map.fastly.net, PROXY
DOMAIN,spotify.map.fastlylb.net, PROXY
DOMAIN-SUFFIX,audio-ak-spotify-com.akamaized.net, PROXY
DOMAIN-SUFFIX,byspotify.com, PROXY
DOMAIN-SUFFIX,heads4-ak-spotify-com.akamaized.net, PROXY
DOMAIN-SUFFIX,pscdn.co, PROXY
DOMAIN-SUFFIX,scdn.co, PROXY
DOMAIN-SUFFIX,spoti.fi, PROXY
DOMAIN-SUFFIX,spotify-com.akamaized.net, PROXY
DOMAIN-SUFFIX,spotify-everywhere.com, PROXY
DOMAIN-SUFFIX,spotify.com, PROXY
DOMAIN-SUFFIX,spotify.design, PROXY
DOMAIN-SUFFIX,spotifycdn.com, PROXY
DOMAIN-SUFFIX,spotifycdn.net, PROXY
DOMAIN-SUFFIX,spotifycharts.com, PROXY
DOMAIN-SUFFIX,spotifycodes.com, PROXY
DOMAIN-SUFFIX,spotifyforbrands.com, PROXY
DOMAIN-SUFFIX,spotifyjobs.com, PROXY
DOMAIN-SUFFIX,spotifynewsroom.jp, PROXY
DOMAIN-SUFFIX,spotilocal.com, PROXY
DOMAIN-SUFFIX,tospotify.com, PROXY
DOMAIN-KEYWORD,-spotify-, PROXY
DOMAIN-KEYWORD,spotify.com, PROXY
USER-AGENT,Spotify*, PROXY
IP-CIDR,104.154.127.126/32,no-resolve, PROXY
IP-CIDR,35.186.224.47/32,no-resolve, PROXY

[Argument]
Types = input,"Translate,External",tag=[æ­Œè¯]å¯ç”¨ç±»å‹ï¼ˆå¤šé€‰ï¼‰,desc=è¯·é€‰æ‹©è¦æ·»åŠ çš„æ­Œè¯é€‰é¡¹ï¼Œå¦‚æœä¸ºå¤šé€‰ï¼Œåˆ™ä¼šè‡ªåŠ¨å†³å®šæä¾›çš„æ­Œè¯ç±»å‹ã€‚
Vendor = select,"Google","Microsoft",tag=[ç¿»è¯‘å™¨]æœåŠ¡å•†API,desc=è¯·é€‰æ‹©ç¿»è¯‘å™¨æ‰€ä½¿ç”¨çš„æœåŠ¡å•†APIï¼Œæ›´å¤šç¿»è¯‘é€‰é¡¹è¯·ä½¿ç”¨BoxJsã€‚
LrcVendor = select,"NeteaseMusic","QQMusic","NeteaseMusicNodeJS",tag=[æ­Œè¯]æœåŠ¡å•†API,desc=è¯·é€‰æ‹©å¤–éƒ¨æºæ‰€ä½¿ç”¨çš„æœåŠ¡å•†APIã€‚

[Script]
http-response ^https?:\/\/api\.spotify\.com\/v1\/tracks\? requires-body=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.1/response.bundle.js, tag=DualSubs.Spotify.Tracks.response.json, argument=[{Types},{Vendor},{LrcVendor}]

http-request ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json requires-body=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.1/request.bundle.js, tag=DualSubs.Spotify.Lyrics.request.json, argument=[{Types},{Vendor},{LrcVendor}]
http-request ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*) requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Spotify/releases/download/v1.9.1/request.bundle.js, tag=DualSubs.Spotify.Lyrics.request.proto, argument=[{Types},{Vendor},{LrcVendor}]

http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json(.*)subtype=Translate requires-body=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/Translate.response.bundle.js, tag=DualSubs.Spotify.Translate.Lyrics.response.json, argument=[{Types},{Vendor},{LrcVendor}]
http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*)subtype=Translate requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/Translate.response.bundle.js, tag=DualSubs.Spotify.Translate.Lyrics.response.proto, argument=[{Types},{Vendor},{LrcVendor}]

http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/(.+)\?(.*)format=json(.*)subtype=External requires-body=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=DualSubs.Spotify.External.Lyrics.response.json, argument=[{Types},{Vendor},{LrcVendor}]
http-response ^https?:\/\/spclient\.wg\.spotify\.com\/color-lyrics\/v2\/track\/\w+\?(.*)subtype=External requires-body=1, binary-body-mode=1, script-path=https://github.com/DualSubs/Universal/releases/latest/download/External.Lyrics.response.bundle.js, tag=DualSubs.Spotify.External.Lyrics.response.proto, argument=[{Types},{Vendor},{LrcVendor}]

[MITM]
hostname = api.spotify.com, spclient.wg.spotify.com
